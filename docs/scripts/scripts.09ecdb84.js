!function(){"use strict";angular.module("facetApp",["ui.router","seco.facetedSearch","ngTable","angular.filter"]).constant("_",_).constant("RESULTS_PER_PAGE",25).constant("PAGES_PER_QUERY",1).config(["$urlMatcherFactoryProvider",function(a){a.strictMode(!1)}]).config(["$urlRouterProvider",function(a){a.otherwise("/")}]).config(["$stateProvider",function(a){a.state("facetApp",{url:"/",templateUrl:"views/norssit.html",controller:"MainController",controllerAs:"vm"})}])}(),function(){"use strict";function a(a,b,c){function d(a){return m.getResults(a,"?familyName ?givenName")}function e(){var b=angular.copy(g);return a.when(b)}function f(){return k}this.getResults=d,this.getFacets=e,this.getFacetOptions=f;var g={entryText:{facetId:"entryText",predicate:"<http://ldf.fi/schema/person_registry/entryText>",name:"Haku",enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/norssit/wikipedia> [] .",label:"Wikipedia"},{id:"sotasampo",pattern:"?id <http://ldf.fi/norssit/warsa> [] .",label:"Sotasampo"},{id:"kansallisbiografia",pattern:"?id <http://ldf.fi/norssit/kansallisbiografia> [] .",label:"Kansallisbiografia"},{id:"wikidata",pattern:"?id <http://ldf.fi/norssit/wikidata> [] .",label:"Wikidata"},{id:"ulan",pattern:"?id <http://ldf.fi/norssit/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/norssit/viaf> [] .",label:"VIAF"}],enabled:!0,name:"Linkit"},familyName:{facetId:"familyName",predicate:"<http://schema.org/familyName>",name:"Sukunimi"},birthPlace:{facetId:"birthPlace",predicate:"<http://schema.org/birthPlace>",name:"Syntymäpaikka",enabled:!0},enrollmentYear:{facetId:"enrollmentYear",predicate:"<http://ldf.fi/schema/person_registry/enrollmentYear>",name:"Aloittamisvuosi",enabled:!0},matriculationYear:{facetId:"matriculationYear",predicate:"<http://ldf.fi/schema/person_registry/matriculationYear>",name:"Valmistumisvuosi",enabled:!0},hobby:{facetId:"hobby",predicate:"<http://schema.org/hobby>",name:"Harrastus"}},h=" PREFIX hobbies: <http://ldf.fi/hobbies/>  PREFIX norssit: <http://ldf.fi/norssit/>  PREFIX nach: <http://ldf.fi/norssit/achievements/>  PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX person_registry: <http://ldf.fi/schema/person_registry/>  PREFIX places: <http://ldf.fi/places/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX relatives: <http://ldf.fi/relatives/>  PREFIX schema: <http://schema.org/>  PREFIX schemax: <http://topbraid.org/schemax/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",i=' SELECT * WHERE {  {     <RESULT_SET>   }   OPTIONAL { ?id schema:givenName ?givenName . }  OPTIONAL { ?id schema:familyName ?familyName . }  OPTIONAL {    ?id schema:birthPlace ?birthPlaceId .    BIND(REPLACE(STR(?birthPlaceId), "http://ldf.fi/places/", "") AS ?birthPlace)   }  OPTIONAL { ?id schema:birthDate ?birthDate . }  OPTIONAL { ?id schema:deathDate ?deathDate . }  OPTIONAL {    ?id schema:hobby ?hobby_id .    BIND(REPLACE(STR(?hobby_id), "http://ldf.fi/hobbies/", "") AS ?hobby)   }  OPTIONAL { ?id schema:image ?image . }  OPTIONAL { ?id dct:description ?description . }  OPTIONAL { ?id person_registry:pageNumber ?pageNumber . }  OPTIONAL { ?id person_registry:pageImageURL ?pageImageURL . }  OPTIONAL { ?id person_registry:relatedNorssi ?relatedNorssi . }  OPTIONAL { ?id person_registry:enrollmentYear ?enrollmentYear . }  OPTIONAL { ?id person_registry:matriculationYear ?matriculationYear . }  OPTIONAL { ?id person_registry:entryText ?entryText . }  OPTIONAL { ?id norssit:wikipedia ?wikipedia . }  OPTIONAL { ?id norssit:viaf ?viaf . }  OPTIONAL { ?id norssit:kansallisbiografia ?kansallisbiografia . }  OPTIONAL { ?id norssit:wikidata ?wikidata . }  OPTIONAL { ?id norssit:ulan ?ulan . }  OPTIONAL { ?id norssit:warsa ?warsa . }  OPTIONAL { ?id norssit:kb ?kb . }  OPTIONAL {     ?ach rdfs:subPropertyOf* nach:involved_in .    ?id ?ach ?achievement__id .     ?achievement__id skos:prefLabel ?achievement__label .    ?achievement__id norssit:wikipedia ?achievement__wikipedia .  } }',j="https://ldf.fi/norssit/sparql",k={endpointUrl:j,rdfClass:"<http://xmlns.com/foaf/0.1/Person>",preferredLang:"fi"},l={queryTemplate:i,prefixes:h,pagesPerQuery:2},m=new c(j,l)}angular.module("facetApp").service("norssitService",a),a.$inject=["$q","_","FacetResultHandler"]}(),function(){"use strict";function a(a,b,c){function d(c,d){return a("navbar-fi.html").then(function(b){return d.html(b),a("views/subnavbar.html")}).then(function(a){return angular.element("#subnav").html(a),b(d.contents())(c)})}function e(){function a(){c.open({templateUrl:"views/help.html",size:"lg"})}var b=this;b.showHelp=a}return{link:d,controller:e,controllerAs:"vm"}}angular.module("facetApp").directive("wsNavbar",a),a.$inject=["$templateRequest","$compile","$uibModal"]}(),function(){"use strict";function a(a){function b(){return a.$close()}var c=this;c.close=b,c.$onInit=function(){c.person=c.resolve.person}}angular.module("facetApp").component("registerPageModal",{templateUrl:"views/page-modal.html",controller:a,bindings:{resolve:"<",close:"&",dismiss:"&"}}),a.$inject=["$scope"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(a){return c.castArray(a)}function j(){o.tableParams=new f({count:d},{getData:m})}function k(a){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return a}}})}function l(){var a=e.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function m(a){return o.isLoadingResults=!0,o.pager.getPage(a.page()-1,a.count()).then(function(a){return o.pager.getTotalCount().then(function(b){return o.tableParams.total(b),a}).then(function(a){return o.isLoadingResults=!1,a})})}function n(a,b){h.updateUrlParams(b),o.isLoadingResults=!0,e.getResults(b).then(function(a){o.pager=a,o.tableParams?(o.tableParams.page(1),o.tableParams.reload()):j()})}var o=this;o.openPage=k,o.toArray=i;var p=a.$on("sf-initial-constraints",function(a,b){n(a,b),p()});a.$on("sf-facet-constraints",n),e.getFacets().then(function(b){o.facets=b,o.facetOptions=l(),o.facetOptions.scope=a,o.handler=new g(o.facetOptions)})}angular.module("facetApp").controller("MainController",a),a.$inject=["$scope","$uibModal","_","RESULTS_PER_PAGE","norssitService","NgTableParams","FacetHandler","facetUrlStateHandlerService"]}(),angular.module("facetApp").run(["$templateCache",function(a){"use strict";a.put("views/achievements-popover.html",'<div> <p ng-repeat="achievement in vm.toArray(person.achievement)"><a ng-href="{{ achievement.wikipedia }}">{{ achievement.label }}</a></p> </div>'),a.put("views/help.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10 text-left"> <h3 class="modal-title">Norssit</h3> </div> <div class="col-xs-2"> <a href="#" ng-click="$close()" class="no-decoration btn-lg pull-right glyphicon glyphicon-remove"></a> </div> </div> </div> <div class="modal-body"> <p> Matrikkelin tietoja voi selata käyttöliittymässä käyttämällä vasemmalla olevia suodattimia. Hakeaksesi rekisterillä tekstihaulla, kirjoita haku \'Haku\'-kenttään. Poistaaksesi hakurajauksen, paina X-nappia hakukentän oikealla puolella. Jokaisella suodattimella on oma hakukenttä sekä lista suodattimen vaihtoehdoista, josta voi valita haluamansa ehdon. Tulosten määrä vaihtoehdolla näkyy suluissa valinnan nimen perässä. Valinnan voi poistaa valitsemalla vaihtoehdon \'-- No Selection --\'. Jokaisesta suodattimesta voi valita vain yhden vaihtoehdon, jolloin henkilölistausta suodatetaan valintojen perusteella. Tuloslistaa voi suodattaa käyttäen eri suodattimia yhdessä. </p> <p> <h4>Suodattimien valinta:</h4> <ol> <li>Valitse joku suodattimista ja avaa suodatin painamalla \'+\'-nappia suodattimen otsikon oikealla puolella.</li> <li>Valitse suodattimeen arvo listalta tai hae kirjoittamalla listan yllä olevaan tekstikenttään. Jos suodatinehtoa haetaan tekstikentän avulla alla oleva lista suodattimista päivittyy kirjoittaessa.</li> <li>Suodatinehdon voi valita klikkaamalla sitä listalta, tai poistaa valitsemalla \'-- No Selection --\' listan alusta. </li> <li>Henkilöiden lista päivittyy suodattimien oikealla puolella.</li> <li>Tuloksia voi nyt suodattaa tarvittaessa lisää toistamalla toisella suodattimella edelliset askeleet 1-4.</li> </ol> </p> </div>'),a.put("views/norssit.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-1 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="http://www.norssit.fi/images/norssi_logo.jpg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n  --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <h1>Vanhat Norssit semanttisessa webissä</h1> <p> Norssimatrikkelihaku. Voit rajata tulosta tekemällä valintoja suodattimista ja selata henkilöihin liittyvää tietoa linkkien kautta. Lähde: <a href="http://www.norssit.fi/matrikkeli_1867-1992.html">Helsingin Norssin matrikkeli 1867-1992</a> </p> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div class="facets"> <seco-text-facet data-options="vm.facets.entryText"></seco-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <seco-basic-facet data-options="vm.facets.familyName"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.birthPlace"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.enrollmentYear"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.matriculationYear"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.hobby"></seco-basic-facet> </div> </div> </div> <div class="col-md-9 col-lg-10"> <div ng-include="\'views/norssit.persons.html\'"></div> </div> </div> </div>'),a.put("views/norssit.persons.html",'<table class="table table-striped norssi-table ng-table-responsive" ng-table="vm.tableParams"> <thead> <tr> <th class="col-xs-4">Nimi</th> <th class="col-xs-1">Norssi</th> <th class="col-xs-1">Linkit</th> <th class="col-xs-3"><span class="hidden-xs hidden-sm">Harrastukset</span></th> <th class="col-xs-3 hidden-xs hidden-sm">Matrikkeliteksti</th> </tr> </thead> <tbody> <tr ng-show="!vm.isLoadingResults" ng-repeat="person in $data"> <td class="person-image-container" data-title="\'Nimi\'"> <div ng-class="::{ \'name-col col-md-12 col-lg-7\': person.image }"> <a ng-href="{{ ::person.id }}">{{ ::person.givenName }} {{ ::person.familyName }}</a> <br> {{ ::person.birthPlace }} {{ ::person.birthDate | date:\'dd.MM.yyyy\' }} - {{ ::person.deathDate | date:\'dd.MM.yyyy\' }} </div> <div ng-if="::&quot;person.image&quot;" class="name-col col-md-12 col-lg-5"> <div ng-repeat="img in ::vm.toArray(person.image)" ng-class="{ \'col-md-12\': ($first && $last), \'col-sm-6\': !($first && $last) }" class="person-img-col vcenter"> <img uib-popover-template="\'views/profile-image-popover.html\'" popover-trigger="\'mouseenter\'" popover-placement="auto right" popover-append-to-body="true" class="person-image img img-responsive" ng-src="{{ img  }}"> </div> </div> </td> <td data-title="\'Norssi\'"> {{ ::person.enrollmentYear || \'?\' }} - {{ ::person.matriculationYear || \'?\' }} </td> <td class="links" data-title="\'Linkit\'"> <div ng-if="::person.achievement"> <a href="" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto top">Saavutukset</a> </div> <a class="link" ng-if="::person.wikipedia" ng-href="{{ ::person.wikipedia }}">Wikipedia</a> <a class="link" ng-if="::person.kansallisbiografia" ng-href="{{ ::person.kansallisbiografia }}">Kansallisbiografia</a> <a class="link" ng-if="::person.warsa" ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsa }}">Sotasampo</a> <a class="link" ng-if="::person.ulan" ng-href="{{ ::person.ulan }}">ULAN</a> <a class="link" ng-if="::person.viaf" ng-href="{{ ::person.viaf }}">VIAF</a> </td> <td data-title="\'Harrastukset\'"> <div ng-if="::person.hobby"><span class="visible-xs-block visible-sm-block">Harrastukset: </span>{{ ::person.hobby | join:\', \' }}</div> <button class="page-btn visible-xs-block visible-sm-block btn btn-default" ng-click="::vm.openPage(person)">Matrikkelisivu</button> </td> <td data-title="\'Matrikkeliteksti\'" class="hidden-xs hidden-sm" uib-popover-template="\'views/register-text-popover.html\'" popover-trigger="\'mouseenter\'" popover-append-to-body="true" popover-placement="auto left"> <a class="no-style" href="" ng-click="::vm.openPage(person)">{{ ::person.entryText | truncate: 500 : \'...\' : true }}</a> </td> </tr> </tbody> </table> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),a.put("views/page-modal.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10"> <h3 class="modal-title">{{ $ctrl.person.givenName }} {{ $ctrl.person.familyName }}</h3> </div> <div class="col-xs-2 text-right"> <button ng-click="$ctrl.close()" class="btn btn-default" aria-label="Sulje"> <span aria-hidden="true" class="glyphicon glyphicon-remove"></span> </button> </div> </div> </div><div class="modal-body"> <img class="img img-responsive" ng-src="{{ $ctrl.person.pageImageURL }}"> </div>'),a.put("views/profile-image-popover.html",'<div> <img class="img img-responsive" ng-src="{{ img }}"> </div>'),a.put("views/register-text-popover.html","<div> <pre>{{ person.entryText }}</pre> </div>"),a.put("views/subnavbar.html",'<ul class="nav navbar-nav"> <li><a href="" id="show-help" ng-click="vm.showHelp()">Ohje</a></li> </ul>')}]);